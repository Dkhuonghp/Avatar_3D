'use strict';

var React = require('react');
var CurveModifier$1 = require('three/examples/jsm/modifiers/CurveModifier');

var CurveModifier = /*#__PURE__*/React.forwardRef(function (_ref, ref) {
  var children = _ref.children,
      curve = _ref.curve;

  var _React$useState = React.useState(),
      object3D = _React$useState[0],
      setObj = _React$useState[1];

  var original = React.useRef();
  var modifier = React.useRef();
  React.useImperativeHandle(ref, function () {
    return {
      moveAlongCurve: function moveAlongCurve(val) {
        var _modifier$current;

        (_modifier$current = modifier.current) == null ? void 0 : _modifier$current.moveAlongCurve(val);
      }
    };
  });
  React.useEffect(function () {
    if (!modifier.current && original.current && ref) {
      modifier.current = new CurveModifier$1.Flow(original.current);
      setObj(modifier.current.object3D);
    }
  }, [children, ref]);
  React.useEffect(function () {
    if (original.current && curve) {
      var _modifier$current2;

      (_modifier$current2 = modifier.current) == null ? void 0 : _modifier$current2.updateCurve(0, curve);
    }
  }, [curve]);
  return object3D ? /*#__PURE__*/React.createElement("primitive", {
    object: object3D
  }) : /*#__PURE__*/React.cloneElement(React.Children.only(children), {
    ref: original
  });
});

module.exports = CurveModifier;
